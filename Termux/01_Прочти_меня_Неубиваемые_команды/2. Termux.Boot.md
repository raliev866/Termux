
# Уровень 2: Использование Termux:Boot (автозапуск)

## restore-scripts.sh - команда скрипт восстановления TERMUX:BOOT

Установи Termux:Boot из F-Droid. Это приложение запускает скрипты при загрузке Android .

```bash
mkdir -p ~/.termux/boot/
```

Создай скрипт восстановления `~/.termux/boot/restore-scripts.sh`:
```bash
#!/data/data/com.termux/files/usr/bin/sh
# Восстанавливает права и ссылки при загрузке

# Восстановить права на все скрипты в ~/bin
chmod +x ~/bin/* 2>/dev/null
chmod +x /data/data/com.termux/files/usr/bin/* 2>/dev/null

# Проверить и восстановить ссылки
[ ! -f ~/оглавление ] && ln -s ~/все ~/оглавление 2>/dev/null
[ ! -f /data/data/com.termux/files/usr/bin/оглавление ] && cp ~/все /data/data/com.termux/files/usr/bin/оглавление 2>/dev/null
```














Дальше нужно просто положить нужные скрипты в специальную папку.

## Как пользоваться Termux:Boot (пошагово)

Вы уже выполнили два самых важных шага: установили приложение и создали скрипт. Теперь сделаем так, чтобы он действительно работал при загрузке.

**Шаг 1: Проверьте, что папка для скриптов существует**
Termux:Boot ищет скрипты в папке `~/.termux/boot/` . Давайте убедимся, что она на месте. Введите в Termux:
```bash
ls -la ~/.termux/boot/
```
Вы должны увидеть ваш файл `restore-scripts.sh` в списке.

Полный путь к этой папке: 
```bash
/data/data/com.termux/files/home/.termux/boot/ 
```
Папка ~/.termux/boot/ — это специальное, строго определенное место, которое Termux:Boot проверяет при загрузке устройства . Она находится внутри защищенной области Termux, а не в общей памяти телефона.


**Шаг 2: Убедитесь, что у скрипта есть права на выполнение**
Это самая частая причина, по которой скрипты не запускаются. На всякий случай дайте вашему скрипту явное разрешение на запуск:
```bash
chmod +x ~/.termux/boot/restore-scripts.sh
```

**Шаг 3: Перезагрузите телефон**
Это самый простой способ проверить, работает ли Termux:Boot. После перезагрузки он автоматически запустит все скрипты, лежащие в папке `~/.termux/boot/` .

**Шаг 4: Как проверить, что скрипт сработал**
После перезагрузки откройте Termux и проверьте, всё ли на месте.
*   Например, в вашем скрипте есть команда `chmod +x ~/bin/*`. После перезагрузки убедитесь, что у всех скриптов в папке `~/bin` стоят права на выполнение. Можно проверить любой из них:
    ```bash
    ls -l ~/bin/оглавление
    ```
    В выводе должны быть буквы `x` (например, `-rwx------`).
*   Также скрипт восстанавливает ссылки. Проверьте, работает ли команда `оглавление` без ошибок:
    ```bash
    оглавление
    ```
    (Если вы не хотите, чтобы она запускалась прямо сейчас, просто нажмите `Ctrl+C` для отмены. Главное, чтобы не было ошибки "command not found").

### Что можно улучшить в скрипте?

Ваш скрипт хорош, но его можно сделать ещё надёжнее.
1.  **Добавьте `termux-wake-lock`**. Эта команда не даст телефону уйти в глубокий сон, пока скрипт выполняется . Добавьте её самой первой строчкой после `#!/bin/sh`. Файл `~/.termux/boot/restore-scripts.sh` должен выглядеть так:
    ```bash
    #!/data/data/com.termux/files/usr/bin/sh
    # Предотвращаем засыпание телефона во время выполнения скрипта
    termux-wake-lock

    # Восстанавливаем права на все скрипты в ~/bin
    chmod +x ~/bin/* 2>/dev/null
    # ... (остальные ваши команды)
    ```

2.  **Если скрипт не сработает**. Иногда Android слишком агрессивно оптимизирует батарею и не даёт приложениям запускаться. В настройках телефона найдите раздел «Батарея» или «Оптимизация», найдите там приложения **Termux** и **Termux:Boot** и отключите для них оптимизации или поставьте «Без ограничений» .

**Главное**: Termux:Boot — это «тихий» работник. Он не показывает никаких окон, просто выполняет скрипты в фоне и всё. Поэтому после перезагрузки вы не увидите никаких сообщений, просто ваши команды `оглавление`, `бекап` и другие продолжат работать как ни в чём не бывало.









### ❌ Можно ли переместить эту папку?

**Нет, перемещать эту папку категорически нельзя.** И вот почему:

1.  **Это не сработает**: Termux:Boot запрограммирован искать скрипты исключительно в `~/.termux/boot/` . Если папки там не будет, он просто ничего не запустит.
2.  **Проблемы с безопасностью и правами**: Папка `~/storage/` (которая ведет в `/storage/emulated/0/`) — это всего лишь «мост» для доступа к файлам телефона . У файлов в этом хранилище другие права доступа, и у Termux может не хватить прав для их выполнения как системных скриптов при загрузке. Именно поэтому все настройки Termux хранятся в его собственной защищенной папке .

### ✅ Что нужно сделать прямо сейчас

Вам не нужно перемещать папку. Вам нужно просто **поместить ваш скрипт в уже существующую, правильную папку**.

Выполните эту команду в Termux. Она скопирует ваш скрипт из резервной копии туда, где он должен быть:

```bash
cp "/storage/emulated/0/Documents/15_Настройки_скрипты_Termux_бэкап_рестор/restore-scripts.sh" ~/.termux/boot/
```

**Или**, если вы хотите создать улучшенную версию скрипта прямо сейчас (с `termux-wake-lock`), выполните эту команду. **Важно**: замените `u0_a2600` на имя вашего пользователя, которое вы видели в выводе команды `ls -la`.

```bash
cat > ~/.termux/boot/restore-scripts.sh << 'EOF'
#!/data/data/com.termux/files/usr/bin/sh
# Предотвращаем засыпание телефона во время выполнения скрипта
termux-wake-lock

# Восстанавливаем права на все скрипты в ~/bin
chmod +x /data/data/com.termux/files/home/bin/* 2>/dev/null
chmod +x /data/data/com.termux/files/usr/bin/* 2>/dev/null

# Проверить и восстановить ссылки (пример для ваших команд)
[ ! -f /data/data/com.termux/files/home/оглавление ] && ln -s /data/data/com.termux/files/home/все /data/data/com.termux/files/home/оглавление 2>/dev/null
[ ! -f /data/data/com.termux/files/usr/bin/оглавление ] && cp /data/data/com.termux/files/home/все /data/data/com.termux/files/usr/bin/оглавление 2>/dev/null
EOF
```

После этого снова сделайте скрипт исполняемым и перезагрузите телефон для проверки:
```bash
chmod +x ~/.termux/boot/restore-scripts.sh
```

### **Короткий итог**
*   Папка `~/.termux/boot/` находится **внутри Termux** и перемещать её нельзя .
*   В неё нужно **положить скрипт**, который вы хотите запускать при загрузке.
*   Ваша папка `/storage/emulated/0/Documents/15_Настройки_скрипты_Termux_бэкап_рестор/` — это **отличное место для хранения резервных копий**, но Termux не будет оттуда запускать скрипты автоматически.














